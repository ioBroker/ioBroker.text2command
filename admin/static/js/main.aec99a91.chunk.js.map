{"version":3,"sources":["serviceWorker.js","components/Rule.js","components/Drawer.js","components/RuleEditor.js","components/CreateRuleDialog.js","components/Layout.js","App.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","Rule","React","forwardRef","props","ref","name","handleEdit","handleCopy","rule","isDragging","connectDragSource","connectDropTarget","id","selectRule","selectedRule","_break","matchingRules","unsavedRules","index","theme","removeMatched","words","unique","classes","makeStyles","listItem","cursor","transition","position","paddingTop","paddingBottom","borderBottom","palette","text","primary","startsWith","listItemText","listItemTextPrimary","color","textOverflow","overflow","whiteSpace","listItemTextSecondary","opacity","type","fontStyle","dot","backgroundColor","top","right","height","fontSize","borderRadius","padding","textAlign","maximize","dark","marginTop","spacing","ruleButton","editButton","width","bottom","left","paddingLeft","emptyButton","multiline","marginBottom","elementRef","useRef","useImperativeHandle","getNode","current","selectRuleMemo","useCallback","handleEditMemo","handleCopyMemo","useState","ruleStyle","setRuleStyle","useEffect","length","matchingRule","find","item","indexOf","setTimeout","secondary","light","timer","background","default","style","Object","assign","ListItem","onClick","selected","className","clsx","root","ListItemText","ListItemIcon","Tooltip","title","I18n","t","IconButton","size","ItemTypes","DropTarget","hover","monitor","component","node","dragIndex","getItem","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","hoverClientY","getClientOffset","y","moveRule","connect","dropTarget","DragSource","beginDrag","dragSource","isTouchDevice","a","check","userAgent","vendor","opera","test","substr","mobileCheck","maxTouchPoints","msMaxTouchPoints","CustomTooltip","withStyles","tooltip","Drawer","getDefaultSettings","setState","localSettings","settings","onAlive","val","alive","onResponse","toast","toastError","socket","getState","instance","handleTextCommand","event","textCommand","target","value","testTimer","clearTimeout","matched","findMatchingRules","map","number","handleSubmit","iconPlay","key","err","handleOpenSettingsModal","isSettingsDialogOpen","handleDialogSelectIdSubmit","selectedSettingsName","handleDelete","removeRule","handleCloseConfirmRemoveDialog","isConfirmRemoveDialogOpen","handleSearch","matchedRules","rules","filter","toLowerCase","includes","filteredRules","searchedValue","toggleSearch","isSearchActive","createSettingsModal","handleClose","isSettingsWasNotSaved","handleChange","undefined","checked","Dialog","open","onClose","fullWidth","onExited","DialogTitle","Typography","variant","align","DialogContent","noValidate","autoComplete","Grid","container","direction","FormControl","settingsItem","InputLabel","Select","width100","onChange","language","MenuItem","Children","toArray","option","selectIdText","TextField","label","sayitInstance","Button","selectIdButton","showDialogSelectId","selectedId","processorId","helperText","processorTimeout","e","FormControlLabel","control","Checkbox","writeEveryAnswer","noNegativeMessage","DialogActions","saveSettings","startIcon","mainIcons","icon","handler","handleOpen","createIcons","iconsData","this","subscribeState","document","getElementsByClassName","scrollIntoView","unsubscribeState","prevProps","prevState","findMatched","JSON","parse","stringify","imagePrefix","onOk","autoFocus","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Alert","elevation","severity","isMobile","closeDrawer","settingsDialog","renderedRules","additionalIcons","push","Box","main","Toolbar","toolbar","disableGutters","search","InputProps","endAdornment","closeBtn","flexGrow","iconNotAlive","DndProvider","backend","TouchBackend","HTML5Backend","List","list","onKeyDown","inputProps","play","renderConfirmDialog","renderSelectIdDialog","renderToast","Component","boxSizing","minWidth","overflowX","overflowY","header","minHeight","border","divider","textInput","breakpoints","down","settingsTitle","maxWidth","settingsContent","flexDirection","display","common","white","float","marginRight","flexBasis","RuleEditor","defaultState","editable","args","ack","localRule","showDialog","editIndex","createConfirmModalActions","updateConfig","pendingSelectedRuleId","clearStateOnConfirmModalUnmount","revertChangesFromConfig","cancelSavingChanges","closeConfirmDialog","dontSaveAndGo","handleSaveAndGo","submitForm","saveAndGoBtn","btnDanger","createSaveSettingsForm","handleSave","isLocalStateWasUpdated","revertChanges","emptyButtons","confirmChanges","createInput","onOpenSelectDialog","note","disabled","keywords","onSwitchChange","inputOid","inputOidButton","textField","rowPadding","switchControl","Switch","FormLabel","createOptionsData","handlers","isKeyWordsDisabled","keywordsText","breakOnSwitch","openSelectIdDialog","param1OnSwitch","param2Text","param2OnSwitch","param3OnSwitch","confirmText","confirmOnSwitch","createInputHandlers","_this","arg","showDialogId","onIDSelected","unsavedRule","isEqual","wasChangedGlobally","setUnsavedRule","removeUnsavedRule","lang","forceUpdate","isLeftBarOpen","toggleLeftBar","toggleIcon","box","boxMobile","boxDesktop","Paper","gridTemplateColumns","rowSpace","PureComponent","margin","justifyContent","mainTitle","row","alignItems","marginLeft","zIndex","noRulesText","fontWeight","CreateRuleDialog","defaultRule","isDisabled","setRuleOnMount","isEdit","cleanState","isCopy","finishEdit","getAvailableOptions","commands","uniqueOptions","concat","getUniqueName","ruleName","matchingNames","slice","isUnique","lastChar","createForm","onSubmitHandler","handleSubmitOnCopy","handleSubmitOnEdit","handleSubmitOnCreate","FormGroup","shrink","isError","labelId","select","keyCode","preventDefault","stopPropagation","existingNames","setDialogContent","isOpen","onEnter","Layout","getSelectedLanguageCommands","getLanguage","entries","command","rest","template","sourceRule","_","sortRules","splice","add","uuid","shortDataRule","isUnsavedChanges","values","updateRule","newRule","editableRule","updatedRuleOptions","_rule","it","readConfig","newConfig","saveConfig","currentSelectedRule","ids","updatedCurrentRules","updatedRules","getRuleShortData","getDataFromConfig","currentRules","obj","alert","ready","localStorage","actualRules","isRuleWasUpdatedGlobally","newState","localeSettings","closeModal","setItem","menuSize","parseFloat","rulesWithId","en","setLanguage","Fragment","anchor","themeType","renderModalDialog","customClassName","hidden","opened","layout","primaryMinSize","primaryIndex","secondaryMinSize","onSecondaryPaneSizeChange","onDragEnd","toString","secondaryInitialSize","withWidth","App","extendedProps","translations","require","getSystemConfig","systemConfig","showError","getObject","adapterName","native","setObject","bind","renderError","GenericApp","logo","themeName","Utils","getThemeName","version","host","Sentry","dsn","release","integrations","SentryIntegrations","build","ReactDOM","render","onThemeChange","_theme","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.aec99a91.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n\twindow.location.hostname === \"localhost\" ||\n\t\t// [::1] is the IPv6 localhost address.\n\t\twindow.location.hostname === \"[::1]\" ||\n\t\t// 127.0.0.1/8 is considered localhost for IPv4.\n\t\twindow.location.hostname.match(\n\t\t\t/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n\t\t)\n);\n\nexport function register(config) {\n\tif (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n\t\t// The URL constructor is available in all browsers that support SW.\n\t\tconst publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n\t\tif (publicUrl.origin !== window.location.origin) {\n\t\t\t// Our service worker won't work if PUBLIC_URL is on a different origin\n\t\t\t// from what our page is served on. This might happen if a CDN is used to\n\t\t\t// serve assets; see https://github.com/facebook/create-react-app/issues/2374\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener(\"load\", () => {\n\t\t\tconst swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n\t\t\tif (isLocalhost) {\n\t\t\t\t// This is running on localhost. Let's check if a service worker still exists or not.\n\t\t\t\tcheckValidServiceWorker(swUrl, config);\n\n\t\t\t\t// Add some additional logging to localhost, pointing developers to the\n\t\t\t\t// service worker/PWA documentation.\n\t\t\t\tnavigator.serviceWorker.ready.then(() => {\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\"This web app is being served cache-first by a service \" +\n\t\t\t\t\t\t\t\"worker. To learn more, visit http://bit.ly/CRA-PWA\"\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Is not localhost. Just register service worker\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction registerValidSW(swUrl, config) {\n\tnavigator.serviceWorker\n\t\t.register(swUrl)\n\t\t.then(registration => {\n\t\t\tregistration.onupdatefound = () => {\n\t\t\t\tconst installingWorker = registration.installing;\n\t\t\t\tif (installingWorker == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tinstallingWorker.onstatechange = () => {\n\t\t\t\t\tif (installingWorker.state === \"installed\") {\n\t\t\t\t\t\tif (navigator.serviceWorker.controller) {\n\t\t\t\t\t\t\t// At this point, the updated precached content has been fetched,\n\t\t\t\t\t\t\t// but the previous service worker will still serve the older\n\t\t\t\t\t\t\t// content until all client tabs are closed.\n\t\t\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\t\t\"New content is available and will be used when all \" +\n\t\t\t\t\t\t\t\t\t\"tabs for this page are closed. See http://bit.ly/CRA-PWA.\"\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onUpdate) {\n\t\t\t\t\t\t\t\tconfig.onUpdate(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// At this point, everything has been precached.\n\t\t\t\t\t\t\t// It's the perfect time to display a\n\t\t\t\t\t\t\t// \"Content is cached for offline use.\" message.\n\t\t\t\t\t\t\tconsole.log(\"Content is cached for offline use.\");\n\n\t\t\t\t\t\t\t// Execute callback\n\t\t\t\t\t\t\tif (config && config.onSuccess) {\n\t\t\t\t\t\t\t\tconfig.onSuccess(registration);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.error(\"Error during service worker registration:\", error);\n\t\t});\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n\t// Check if the service worker can be found. If it can't reload the page.\n\tfetch(swUrl)\n\t\t.then(response => {\n\t\t\t// Ensure service worker exists, and that we really are getting a JS file.\n\t\t\tconst contentType = response.headers.get(\"content-type\");\n\t\t\tif (\n\t\t\t\tresponse.status === 404 ||\n\t\t\t\t(contentType != null && contentType.indexOf(\"javascript\") === -1)\n\t\t\t) {\n\t\t\t\t// No service worker found. Probably a different app. Reload the page.\n\t\t\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\t\t\tregistration.unregister().then(() => {\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// Service worker found. Proceed as normal.\n\t\t\t\tregisterValidSW(swUrl, config);\n\t\t\t}\n\t\t})\n\t\t.catch(() => {\n\t\t\tconsole.log(\n\t\t\t\t\"No internet connection found. App is running in offline mode.\"\n\t\t\t);\n\t\t});\n}\n\nexport function unregister() {\n\tif (\"serviceWorker\" in navigator) {\n\t\tnavigator.serviceWorker.ready.then(registration => {\n\t\t\tregistration.unregister();\n\t\t});\n\t}\n}\n","import React, {\n    useRef,\n    useImperativeHandle,\n    useCallback,\n    useState,\n    useEffect,\n} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { DropTarget, DragSource } from 'react-dnd';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport EditIcon from '@material-ui/icons/Edit';\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport MaximizeIcon from '@material-ui/icons/Maximize';\nimport FileCopy from '@material-ui/icons/FileCopy';\n\nconst Rule = React.forwardRef((props, ref) => {\n    const {\n        name,\n        handleEdit,\n        handleCopy,\n        rule,\n        isDragging,\n        connectDragSource,\n        connectDropTarget,\n        id,\n        selectRule,\n        selectedRule,\n        _break,\n        matchingRules,\n        unsavedRules,\n        index,\n        theme,\n        removeMatched,\n        words,\n        unique,\n    } = props;\n\n    const classes = makeStyles({\n        listItem: {\n            cursor: 'pointer',\n            transition: 'background-color 0.3s linear',\n            position: 'relative',\n            paddingTop: 4,\n            paddingBottom: 12,\n            borderBottom: '1px dashed ' + theme.palette.text.primary + (theme.palette.text.primary.startsWith('rgb') ? '' : '30'),\n        },\n        listItemText: {\n        },\n        listItemTextPrimary: {\n            color: theme.palette.text.primary,\n            textOverflow: 'ellipsis',\n            overflow: 'hidden',\n            whiteSpace: 'nowrap',\n        },\n        listItemTextSecondary: {\n            textOverflow: 'ellipsis',\n            overflow: 'hidden',\n            opacity: theme.palette.type === 'dark' ? 0.2 : 0.7,\n            fontStyle: 'italic',\n        },\n        dot: {\n            position: 'absolute',\n            backgroundColor: 'red',\n            top: 3,\n            right: 15,\n            height: 10,\n            fontSize: 10,\n            borderRadius: 10,\n            padding: '0 5px 5px 5px',\n            textAlign: 'center',\n            color: '#FFF',\n        },\n        maximize: {\n            color: theme.palette.error?.dark,\n            marginTop: theme.spacing(1),\n        },\n        ruleButton: {\n            paddingTop: theme.spacing(1.5),\n        },\n        editButton: {\n            height: 32,\n        },\n        words: {\n            fontSize: 12,\n            opacity: 0.5,\n            width: 'calc(100% - 40px)',\n            position: 'absolute',\n            bottom: 4,\n            left: 0,\n            paddingLeft: 17,\n            color: theme.palette.text.primary,\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis'\n        },\n        emptyButton: {\n            width: 30,\n        },\n        multiline: {\n            marginTop: 0,\n            marginBottom: 12,\n        }\n    })();\n\n    const elementRef = useRef(null);\n    connectDragSource(elementRef);\n    connectDropTarget(elementRef);\n    const opacity = isDragging ? 0 : 1;\n    useImperativeHandle(ref, () => ({\n        getNode: () => elementRef.current,\n    }));\n\n    const selectRuleMemo = useCallback(() => selectRule(id), [id, selectRule]);\n    const handleEditMemo = useCallback(() => handleEdit(id), [id, handleEdit]);\n    const handleCopyMemo = useCallback(() => handleCopy(id), [id, handleCopy]);\n\n    const [ruleStyle, setRuleStyle] = useState({});\n\n    useEffect(() => {\n        if (matchingRules.length) {\n            const matchingRule = matchingRules.find(item => item.indexOf === index);\n            if (matchingRule) {\n                setTimeout(() => setRuleStyle({backgroundColor: theme.palette.type === 'dark' ? theme?.palette?.secondary.dark : theme?.palette?.secondary.light}), matchingRule.timer);\n\n                setTimeout(() => {\n                    setRuleStyle(selectedRule.id === id ? {backgroundColor: theme?.palette?.background?.default} : {});\n                    if (_break || index === matchingRules[matchingRules.length - 1].indexOf) {\n                        removeMatched();\n                    }\n                }, 1500 * (matchingRule.index + 1));\n            } // only when matching rules have been changed\n        } // eslint-disable-next-line\n    }, [matchingRules]);\n\n    let secondary = rule !== name ? rule || '' : '';\n\n    return <div\n        ref={elementRef}\n        style={Object.assign({}, {opacity}, ruleStyle)}>\n        <ListItem\n            onClick={selectRuleMemo}\n            selected={selectedRule?.id === id}\n            className={clsx(selectedRule?.id === id && 'rule-selected')}\n            classes={{root: classes.listItem}}\n        >\n            <ListItemText\n                primary={name}\n                secondary={secondary}\n                classes={{\n                    primary: classes.listItemTextPrimary,\n                    secondary: classes.listItemTextSecondary,\n                    multiline: classes.multiline}}\n                className={classes.listItemText}\n            />\n            <ListItemIcon>\n                {\n                    _break ?\n                        <Tooltip title={I18n.t('Interrupt processing')}>\n                            <MaximizeIcon className={clsx(classes.ruleButton, classes.maximize)} />\n                        </Tooltip>\n                    :\n                        <Tooltip title={I18n.t('Do not interrupt processing')}><ArrowDownwardIcon className={classes.ruleButton} color=\"primary\"/></Tooltip>\n                }\n                {!unique ? <Tooltip title={I18n.t('Copy rule')}>\n                    <IconButton onClick={handleCopyMemo} size=\"small\" className={classes.editButton}>\n                        <FileCopy />\n                    </IconButton>\n                </Tooltip> : <div className={classes.emptyButton} />}\n                <Tooltip title={I18n.t('Edit name or type of rule')}>\n                    <IconButton onClick={handleEditMemo} size=\"small\" className={classes.editButton}>\n                        <EditIcon />\n                    </IconButton>\n                </Tooltip>\n            </ListItemIcon>\n            {unsavedRules[id] && <div className={classes.dot}>{I18n.t('unsaved')}</div>}\n            <div className={classes.words}>[{words}]</div>\n        </ListItem>\n    </div>;\n});\n\nconst ItemTypes = {\n    RULE: 'rule',\n};\n\nexport default DropTarget(\n    ItemTypes.RULE,\n    {\n        hover(props, monitor, component) {\n            if (!component) {\n                return null;\n            }\n\n            const node = component.getNode();\n            if (!node) {\n                return null;\n            }\n            const dragIndex = monitor.getItem().index;\n            const hoverIndex = props.index;\n            if (dragIndex === hoverIndex) {\n                return;\n            }\n\n            const hoverBoundingRect = node.getBoundingClientRect();\n            const hoverMiddleY = (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\n            const clientOffset = monitor.getClientOffset();\n            const hoverClientY = clientOffset.y - hoverBoundingRect.top;\n            if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\n                return;\n            }\n            if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\n                return;\n            }\n            props.moveRule(dragIndex, hoverIndex);\n\n            monitor.getItem().index = hoverIndex;\n        },\n    },\n    connect => ({ connectDropTarget: connect.dropTarget() })\n)(\n    DragSource(\n        ItemTypes.RULE,\n        {\n            beginDrag: props => ({\n                id: props.id,\n                index: props.index,\n            }),\n        },\n        (connect, monitor) => ({\n            connectDragSource: connect.dragSource(),\n            isDragging: monitor.isDragging(),\n        })\n    )(Rule)\n);\n\nRule.propTypes = {\n    removeRule: PropTypes.func,\n    name: PropTypes.string.isRequired,\n    theme: PropTypes.object.isRequired,\n    isDragging: PropTypes.bool,\n    connectDropTarget: PropTypes.func,\n    connectDragTarget: PropTypes.func,\n    _break: PropTypes.bool.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    id: PropTypes.string.isRequired,\n    matchingRules: PropTypes.array,\n    unique: PropTypes.bool,\n    selectedRule: PropTypes.shape({id: PropTypes.string}),\n    unsavedRules: PropTypes.object,\n};\n","import React, { Component, Children } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { DndProvider } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { TouchBackend } from 'react-dnd-touch-backend';\n\nimport withStyles from '@material-ui/core/styles/withStyles';\n\n// Material UI Components\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport List from '@material-ui/core/List';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport Button from '@material-ui/core/Button';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport IconButton from '@material-ui/core/IconButton';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Alert from '@material-ui/lab/Alert';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\n\n// icons\nimport AddIcon from '@material-ui/icons/Add';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport CachedIcon from '@material-ui/icons/Cached';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SearchIcon from '@material-ui/icons/Search';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport FormatClearIcon from '@material-ui/icons/FormatClear';\nimport ClearIcon from '@material-ui/icons/Close';\nimport WarningIcon from '@material-ui/icons/Warning';\n\nimport I18n from '@iobroker/adapter-react/i18n';\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\n\nimport Rule from './Rule';\nimport CheckIcon from \"@material-ui/icons/Check\";\nimport {Grid} from \"@material-ui/core\";\n\nfunction mobileCheck() {\n    let check = false;\n    (function (a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series([46])0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \\-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ /])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) check = true; }(navigator.userAgent || navigator.vendor || window.opera));\n    return check;\n}\n\nfunction isTouchDevice() {\n    if (!mobileCheck()) {\n        return false;\n    }\n    return (('ontouchstart' in window)\n        || (navigator.maxTouchPoints > 0)\n        || (navigator.msMaxTouchPoints > 0));\n}\n\nconst styles = theme => ({\n    test: {\n        width: '100%',\n        boxSizing: 'border-box',\n        paddingLeft: theme.spacing(1)\n    },\n    main: {\n        minWidth: 300,\n        overflow: 'hidden',\n        height: '100%',\n    },\n    toolbar: {\n        background: theme.palette.primary.main,\n        position: 'relative',\n    },\n    list: {\n        height: 'calc(100% - 48px - 48px - 8px)',\n        overflowX: 'hidden',\n        overflowY: 'auto',\n        paddingTop: 0.,\n    },\n    root: {\n        width: 'calc(100% - 48px)',\n        // '& .MuiInputLabel-outlined-70.MuiInputLabel-marginDense-66': {\n        //     transform: '',\n        // },\n    },\n    header: {\n        minHeight: 44,\n        height: 'auto',\n        padding: theme.spacing(1.3),\n        border: `1px solid ${theme.palette.divider}`,\n    },\n    textInput: {\n        width: '60%',\n        [theme.breakpoints.down('sm')]: {\n            width: '100%',\n        },\n    },\n    settingsTitle: {\n        fontSize: '20px',\n        maxWidth: 145,\n        [theme.breakpoints.down('sm')]: {\n            marginBottom: theme.spacing(1),\n        },\n    },\n    settingsContent: {\n        [theme.breakpoints.down('sm')]: {\n            flexDirection: 'column',\n            display: 'flex',\n        },\n    },\n    closeBtn: {\n        position: 'absolute',\n        top: 0,\n        right: 0,\n        color: theme.palette.common.white,\n    },\n    iconNotAlive: {\n        color: '#ffc10a',\n        float: 'right',\n        marginRight: theme.spacing(1)\n    },\n    search: {\n        flexBasis: '80%',\n        [theme.breakpoints.down('sm')]: {\n            flexBasis: '70%',\n        },\n    },\n    settingsItem: {\n        marginBottom: theme.spacing(3),\n    },\n    width100: {\n        width: '100%',\n    },\n    selectIdText: {\n        width: 'calc(100% - 50px)'\n    },\n    selectIdButton: {\n        minWidth: 40,\n    }\n});\n\nconst tooltipStyles = theme => ({\n    tooltip: {\n        fontSize: 14,\n    },\n});\n\nconst CustomTooltip = withStyles(tooltipStyles)(Tooltip);\n\nclass Drawer extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            textCommand: '',\n            matchingRules: [],\n            isSettingsDialogOpen: false,\n            isConfirmRemoveDialogOpen: false,\n            isSearchActive: false,\n            filteredRules: [],\n            searchedValue: '',\n            localSettings: {\n                language: this.props.settings.language || '',\n                processorId:  this.props.settings.processorId || '',\n                processorTimeout:  this.props.settings.processorTimeout || 1000,\n                sayitInstance:  this.props.settings.sayitInstance || '',\n            },\n            toast: null,\n            alive: false,\n        };\n    }\n\n    componentDidMount() {\n        this.props.socket.subscribeState(`text2command.${this.props.instance}.response`, this.onResponse);\n        this.props.socket.subscribeState(`system.adapter.text2command.${this.props.instance}.alive`, this.onAlive);\n\n        if (this.props.selectedRule && this.props.selectedRule.id) {\n            //scroll to\n            setTimeout(() => {\n                const rules = window.document.getElementsByClassName('rule-selected');\n                if (rules.length) {\n                    rules[0].scrollIntoView()\n                }\n            }, 50);\n        }\n    }\n\n    componentWillUnmount() {\n        this.props.socket.unsubscribeState(`text2command.${this.props.instance}.response`, this.onResponse);\n        this.props.socket.unsubscribeState(`system.adapter.text2command.${this.props.instance}.alive`, this.onAlive);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.settings !== prevProps.settings && this.props.settings) {\n            this.getDefaultSettings();\n        }\n    }\n\n    getDefaultSettings = () => {\n        this.setState({\n            localSettings: {\n                ...this.props.settings,\n            },\n        });\n    };\n\n    onAlive = (id, state) => {\n        if (state && state.val) {\n            !this.state.alive && this.setState({alive: true});\n        } else {\n            this.state.alive && this.setState({alive: false});\n        }\n    };\n\n    onResponse = (id, state) => {\n        if (this.state.toast === null) {\n            this.setState({toast: '', toastError: false});\n        } else\n        if (state) {\n            if (state.val && state.val.match(/^Error\\.|^Fehler\\.|^Ошибка\\./)) {\n                this.props.socket.getState('text2command.' + this.props.instance + '.error')\n                    .then(state =>\n                        this.setState({toast: state && state.val ? state.val : (state.val || ''), toastError: true}));\n            } else {\n                this.setState({toast: state.val || '', toastError: false});\n            }\n        }\n    };\n\n    handleTextCommand = event => {\n        this.setState({textCommand: event.target.value}, () => {\n            this.testTimer && clearTimeout(this.testTimer);\n            this.testTimer = setTimeout(() => {\n                const matched = this.findMatchingRules();\n                this.setState({\n                    matchingRules: matched.map((number, index) => ({\n                        indexOf: number,\n                        timer: index * 1500,\n                        index,\n                    })),\n                });\n            }, 500);\n        });\n    };\n\n    handleSubmit = (event, iconPlay) => {\n        if ((event && event.key === 'Enter') || iconPlay) {\n            this.props.socket.setState(`text2command.${this.props.instance}.text`, this.state.textCommand)\n                .catch(err => console.error(err));\n\n            if (!this.state.alive) {\n                this.setState({toast: I18n.t('Instance is not running'), toastError: true});\n            }\n        }\n    };\n\n    removeMatched = () => {\n        this.setState({matchingRules: []});\n    };\n\n    findMatchingRules() {\n        const text = this.state.textCommand;\n        return text ? window.findMatched(text, JSON.parse(JSON.stringify(this.props.rules))) : [];\n    }\n\n    handleOpenSettingsModal = () => {\n        this.setState({isSettingsDialogOpen: true});\n    };\n\n    handleDialogSelectIdSubmit = (selected, selectedSettingsName) => {\n        this.setState({\n            localSettings: {\n                ...this.state.localSettings,\n                [selectedSettingsName]: selected,\n            },\n        });\n    };\n\n    handleDelete = () => {\n        this.props.removeRule(this.props.selectedRule.id);\n        this.handleCloseConfirmRemoveDialog();\n    };\n\n    handleCloseConfirmRemoveDialog = () => {\n        this.setState({isConfirmRemoveDialogOpen: false});\n    };\n\n    handleSearch = event => {\n        const matchedRules = this.props.rules.filter(rule =>\n            rule.name.toLowerCase().includes(event.target.value.toLowerCase()));\n\n        this.setState({\n            filteredRules: matchedRules || [],\n            searchedValue: event.target.value,\n        });\n    };\n\n    toggleSearch = async () => {\n        await this.setState({isSearchActive: !this.state.isSearchActive});\n    };\n\n    createSettingsModal = () => {\n        if (!this.state.isSettingsDialogOpen) {\n            return null;\n        }\n\n        const { t } = I18n;\n        const options = ['en', 'de', 'ru'];\n        const { classes } = this.props;\n\n        const handleClose = () => {\n            this.setState({\n                isSettingsDialogOpen: false,\n                isSettingsWasNotSaved: true,\n            });\n        };\n\n        const submitSettings = () => this.props.saveSettings(this.state.localSettings, handleClose);\n\n        const handleChange = (event, name) => {\n            let value = event.target.checked !== undefined ? event.target.checked : event.target.value;\n            if (name === 'language' && value === 'system') {\n                value = '';\n            }\n\n            this.setState({\n                localSettings: {\n                    ...this.state.localSettings,\n                    [name]: value,\n                },\n            });\n        };\n\n        return <Dialog\n            open={this.state.isSettingsDialogOpen}\n            onClose={handleClose}\n            fullWidth\n            onExited={this.getDefaultSettings}>\n            <DialogTitle>\n                <Typography variant=\"h4\" component=\"span\" align=\"center\">\n                    {t('Settings')}\n                </Typography>\n            </DialogTitle>\n            <DialogContent>\n                <form noValidate autoComplete=\"off\">\n                    <Grid container direction=\"column\">\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <InputLabel id=\"demo-simple-select-label\">{t('Language')}</InputLabel>\n                            <Select\n                                classes={{ root: classes.width100 }}\n                                onChange={event => handleChange(event, 'language')}\n                                value={\n                                    !this.state.localSettings.language\n                                        ? 'system'\n                                        : this.state.localSettings.language\n                                }>\n                                <MenuItem value=\"system\">{t('System')}</MenuItem>\n                                {Children.toArray(\n                                    options.map(option =>\n                                        <MenuItem value={option}>{t('lang_' + option)}</MenuItem>)\n                                )}\n                            </Select>\n                        </FormControl>\n                        </Grid>\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: clsx(classes.settingsItem, classes.selectIdText) }}>\n                                <TextField\n                                    label={t('Answer in id')}\n                                    value={this.state.localSettings.sayitInstance}\n                                    onChange={event => handleChange(event, 'sayitInstance')}\n                                />\n                            </FormControl>\n                            <Button\n                                variant=\"outlined\"\n                                className={classes.selectIdButton}\n                                onClick={() =>\n                                    this.setState({\n                                        showDialogSelectId: true,\n                                        selectedSettingsName: 'sayitInstance',\n                                        selectedId: this.state.localSettings.sayitInstance || '',\n                                    })}\n                            >...</Button>\n                        </Grid>\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: clsx(classes.settingsItem, classes.selectIdText) }}>\n                                <TextField\n                                    label={t(`Processor's id`)}\n                                    value={this.state.localSettings.processorId}\n                                    onChange={event => handleChange(event, 'processorId')}\n                                />\n                            </FormControl>\n                            <Button\n                                variant=\"outlined\"\n                                className={classes.selectIdButton}\n                                onClick={() =>\n                                    this.setState({\n                                        showDialogSelectId: true,\n                                        selectedSettingsName: 'processorId',\n                                        selectedId: this.state.localSettings.processorId || '',\n                                    })}\n                            >...</Button>\n                        </Grid>\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                            <TextField\n                                label={t('Timeout for processor')}\n                                helperText={t('ms')}\n                                value={this.state.localSettings.processorTimeout}\n                                onChange={e => handleChange(e, 'processorTimeout')}\n                            />\n                        </FormControl>\n                        </Grid>\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                                <FormControlLabel\n                                    control={<Checkbox checked={this.state.localSettings.writeEveryAnswer} onChange={e => handleChange(e, 'writeEveryAnswer')} />}\n                                    label={t('Write to response by every command')}\n                                />\n                            </FormControl>\n                        </Grid>\n                        <Grid item>\n                            <FormControl fullWidth classes={{ root: classes.settingsItem }}>\n                                <FormControlLabel\n                                    control={<Checkbox checked={this.state.localSettings.noNegativeMessage} onChange={e => handleChange(e, 'noNegativeMessage')} />}\n                                    label={t('Do not answer \"I don\\'t understand\" if no rules found')}\n                                />\n                            </FormControl>\n                        </Grid>\n                    </Grid>\n                </form>\n            </DialogContent>\n            <DialogActions>\n                <Button variant=\"contained\" color=\"primary\" onClick={submitSettings} startIcon={<CheckIcon/>}>{I18n.t('Ok')}</Button>\n                <Button variant=\"contained\" onClick={handleClose}startIcon={<CloseIcon/>}>{I18n.t('Cancel')}</Button>\n            </DialogActions>\n        </Dialog>;\n    };\n\n    mainIcons = [\n        {\n            icon: <AddIcon />,\n            handler: () => this.props.handleOpen(true),\n            tooltip: I18n.t('Create rule'),\n        },\n        {\n            icon: <SettingsIcon />,\n            handler: () => this.handleOpenSettingsModal(),\n            tooltip: I18n.t('Settings'),\n        },\n        {\n            icon: <CachedIcon />,\n            handler: () => console.log('refresh'),\n            tooltip: I18n.t('Refresh'),\n        },\n    ];\n\n    createIcons = iconsData =>\n        iconsData.map(({ icon, handler, tooltip }, index) => <CustomTooltip title={tooltip} key={index}>\n            <IconButton onClick={handler}>{icon}</IconButton>\n        </CustomTooltip>);\n\n    renderSelectIdDialog() {\n        return this.state.showDialogSelectId ? (\n            <DialogSelectID\n                imagePrefix={'../..'}\n                socket={this.props.socket}\n                title={'Select ID'}\n                selected={this.state.selectedId}\n                onClose={() => this.setState({ showDialogSelectId: false })}\n                onOk={selected => this.handleDialogSelectIdSubmit(selected, this.state.selectedSettingsName)}\n            />\n        ) : null;\n    }\n\n    renderConfirmDialog() {\n        return this.state.isConfirmRemoveDialogOpen ?\n            <Dialog\n                open={this.state.isConfirmRemoveDialogOpen}\n                onClose={this.handleCloseConfirmRemoveDialog}\n                fullWidth>\n                <DialogTitle>{I18n.t('Are you sure?')}</DialogTitle>\n                <DialogContent>\n                    <Typography component=\"p\">\n                        {I18n.t('You want to delete: %s', this.props.selectedRule.name)}\n                    </Typography>\n                    <DialogActions>\n                        <Button\n                            variant=\"contained\"\n                            color=\"primary\"\n                            autoFocus\n                            onClick={this.handleDelete}\n                            startIcon={<DeleteIcon/>}\n                        >{I18n.t('Delete')}</Button>\n                        <Button\n                            variant=\"contained\"\n                            onClick={this.handleCloseConfirmRemoveDialog}\n                                startIcon={<CloseIcon/>}\n                                >\n                            {I18n.t('Cancel')}\n                        </Button>\n                    </DialogActions>\n                </DialogContent>\n            </Dialog>\n         : null;\n    }\n\n    renderToast() {\n        if (this.state.toast) {\n            return <Snackbar\n                anchorOrigin={{\n                    vertical: 'top',\n                    horizontal: 'right',\n                }}\n                open={true}\n                autoHideDuration={4000}\n                onClose={() => this.setState({toast: ''})}\n            >\n                {\n                    this.state.toastError ?\n                        <Alert elevation={6} variant=\"filled\" onClose={() => this.setState({toast: ''})} severity=\"error\">{this.state.toast}</Alert>\n                        :\n                        <Alert elevation={6} variant=\"filled\" onClose={() => this.setState({toast: ''})} severity=\"success\">{this.state.toast}</Alert>\n                }\n            </Snackbar>\n        } else {\n            return null;\n        }\n    }\n\n    render() {\n        const {\n            selectedRule,\n            moveRule,\n            handleEdit,\n            handleCopy,\n            rules,\n            selectRule,\n            classes,\n            isMobile,\n            closeDrawer,\n        } = this.props;\n\n        const { filteredRules, isSearchActive, searchedValue } = this.state;\n        const settingsDialog = this.createSettingsModal();\n        const renderedRules = isSearchActive && searchedValue.length ? filteredRules : rules;\n        const additionalIcons = [];\n\n        selectedRule &&\n            selectedRule.id &&\n            additionalIcons.push({\n                icon: !isSearchActive && <DeleteIcon />,\n                handler: () =>\n                    this.setState({isConfirmRemoveDialogOpen: true,}),\n                tooltip: I18n.t('Remove rule'),\n                key: 'delete',\n            });\n\n        rules.length &&\n            additionalIcons.push({\n                icon: isSearchActive ? <FormatClearIcon /> : <SearchIcon />,\n                handler: () => this.toggleSearch(),\n                tooltip: I18n.t('Search rule'),\n                key: 'search',\n            });\n\n        return <Box className={classes.main}>\n            <Toolbar position=\"static\" variant=\"dense\" classes={{ root: classes.toolbar }} disableGutters>\n                {isSearchActive ?\n                    <TextField\n                        className={classes.search}\n                        onChange={this.handleSearch}\n                        value={this.state.searchedValue}\n                        InputProps={{\n                            endAdornment: this.state.searchedValue ? (\n                                <IconButton\n                                    onClick={() => this.setState({ searchedValue: '' })}>\n                                    <ClearIcon />\n                                </IconButton>\n                            ) : undefined,\n                        }}\n                        autoFocus\n                    />\n                 : <div>{this.createIcons(this.mainIcons)}</div>}\n                <div>{this.createIcons(additionalIcons)}</div>\n                {isMobile && (\n                    <IconButton className={classes.closeBtn} onClick={closeDrawer}>\n                        <CloseIcon />\n                    </IconButton>\n                )}\n                {!isSearchActive && !this.state.alive ? <div style={{flexGrow: 1}}/> : null}\n                {!isSearchActive && !this.state.alive ? <Tooltip title={I18n.t('Instance is not running')}><WarningIcon className={classes.iconNotAlive}/></Tooltip> : null}\n            </Toolbar>\n\n            <DndProvider backend={isTouchDevice() ? TouchBackend : HTML5Backend}>\n                <List className={classes.list}>\n                    {renderedRules.map((rule, index) => (\n                        <Rule\n                            theme={this.props.theme}\n                            handleEdit={handleEdit}\n                            handleCopy={handleCopy}\n                            unique={rule.unique}\n                            {...rule}\n                            index={index}\n                            moveRule={moveRule}\n                            key={rule.id}\n                            selectRule={selectRule}\n                            selectedRule={selectedRule}\n                            matchingRules={this.state.matchingRules}\n                            unsavedRules={this.props.unsavedRules}\n                            removeMatched={this.removeMatched}\n                        />\n                    ))}\n                </List>\n            </DndProvider>\n\n            <Toolbar className={classes.test} variant=\"dense\" disableGutters>\n                <TextField\n                    onChange={this.handleTextCommand}\n                    label={I18n.t('Test phrase')}\n                    variant=\"outlined\"\n                    size=\"small\"\n                    color=\"primary\"\n                    className={clsx('outlined-basic', classes.root)}\n                    onKeyDown={this.handleSubmit}\n                    value={this.state.textCommand}\n                    inputProps={{style: {padding: '10px 10px'}}}\n                    InputProps={{\n                        endAdornment: this.state.textCommand ? (\n                            <IconButton onClick={() => this.setState({ textCommand: '' })}>\n                                <ClearIcon />\n                            </IconButton>\n                        ) : undefined,\n                    }}\n                />\n                <IconButton\n                    variant=\"outlined\"\n                    onClick={event => this.handleSubmit(event, true)}>\n                    <PlayArrowIcon className={classes.play} />\n                </IconButton>\n            </Toolbar>\n\n            {settingsDialog}\n\n            {this.renderConfirmDialog()}\n            {this.renderSelectIdDialog()}\n            {this.renderToast()}\n        </Box>;\n    }\n}\n\nexport default withStyles(styles)(Drawer);\n\nDrawer.propTypes = {\n    handleOpen: PropTypes.func.isRequired,\n    themeType: PropTypes.string,\n    rules: PropTypes.arrayOf(\n        PropTypes.shape({\n            id: PropTypes.string,\n        })\n    ),\n    instance: PropTypes.number.isRequired,\n    moveRule: PropTypes.func.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    theme: PropTypes.object.isRequired,\n    selectedRule: PropTypes.shape({id: PropTypes.string}),\n    removeRule: PropTypes.func,\n    handleEdit: PropTypes.func.isRequired,\n    handleCopy: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n    settings: PropTypes.object,\n    socket: PropTypes.object.isRequired,\n    saveSettings: PropTypes.func.isRequired,\n    unsavedRules: PropTypes.object,\n    toggleLeftBar: PropTypes.func,\n    isMobile: PropTypes.bool.isRequired,\n    closeDrawer: PropTypes.func,\n};\n","import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\n\nimport {TextField, Switch, Typography, withStyles, Box, FormLabel} from '@material-ui/core';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport FormControl from '@material-ui/core/FormControl';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport Toolbar from '@material-ui/core/Toolbar';\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport CheckIcon from '@material-ui/icons/Check';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport I18n from '@iobroker/adapter-react/i18n';\nimport DialogSelectID from '@iobroker/adapter-react/Dialogs/SelectID';\nimport isEqual from 'lodash.isequal';\n\nconst styles = theme => ({\n    root: {\n        width: '100%',\n        height: '100%',\n        padding: 0,\n        margin: 0,\n        position: 'relative',\n    },\n    box: {\n        display: 'inline-flex',\n        justifyContent: 'space-around',\n        position: 'relative',\n        '& .outlined-basic': {\n            padding: '12px 10px',\n            //border: `2px solid ${theme.palette.grey[700]}`,\n        },\n        [theme.breakpoints.down('md')]: {\n            '& .outlined-basic': {\n                padding: 0,\n            },\n        },\n    },\n    boxMobile: {\n        padding: 0,\n        width: '100%',\n        height: 'calc(100% - 48px - 48px)',\n        overflow: 'auto'\n    },\n    boxDesktop: {\n        padding: theme.spacing(1),\n        width: 'calc(100% - ' + theme.spacing(2) + 'px)',\n        height: 'calc(100% - 48px - 48px - ' + theme.spacing(2) + 'px)',\n        overflow: 'auto'\n    },\n    container: {\n        width: '100%',\n        padding: theme.spacing(2),\n        overflow: 'auto',\n        [theme.breakpoints.down('md')]: {\n            width: 'calc(100% - ' + theme.spacing(3) + 'px)',\n            padding: theme.spacing(1),\n        },\n    },\n    /*textField: {\n        flexBasis: '60%',\n        [theme.breakpoints.down('sm')]: {\n            width: '100%',\n            marginTop: theme.spacing(1),\n        },\n    },*/\n    submitForm: {\n        flexDirection: 'row',\n        //margin: '10px auto 20px',\n        display: 'flex',\n        justifyContent: 'right',\n        width: '100%',\n        [theme.breakpoints.down('xs')]: {\n            flexDirection: 'column',\n        },\n    },\n    mainTitle: {\n        marginBottom: '30px',\n    },\n    rowSpace: {\n        marginBottom: 16,\n    },\n    title: {\n        whiteSpace: 'nowrap'\n    },\n    row: {\n        [theme.breakpoints.down('md')]: {\n            alignItems: 'center',\n        },\n        [theme.breakpoints.down('sm')]: {\n            flexDirection: 'column',\n            alignItems: 'flex-start',\n            textAlign: 'center',\n        },\n    },\n    btnDanger: {\n        marginLeft: 8,\n        [theme.breakpoints.down('xs')]: {\n            marginLeft: 0,\n            marginTop: theme.spacing(0.5),\n        },\n        //backgroundColor: theme.palette.error?.dark,\n    },\n    saveAndGoBtn: {\n        marginRight: 20,\n        [theme.breakpoints.down('xs')]: {\n            marginRight: 0,\n            marginBottom: theme.spacing(0.5),\n        },\n    },\n    toggleIcon: {\n        position: 'absolute',\n        zIndex: 1,\n        opacity: 0.8,\n        top: 8,\n        left: 0,\n        backgroundColor: theme.palette.primary.main,\n        width: 18,\n        height: 25,\n        cursor: 'pointer',\n        padding: '4px 8px 4px 2px',\n        color: '#FFF',\n        borderRadius: '0 5px 5px 0',\n    },\n    switchControl: {\n        //paddingTop: theme.spacing(1),\n        //flexBasis: '60%',\n        marginTop: -5,\n    },\n    emptyButtons: {\n        [theme.breakpoints.down('sm')]: {\n            height: 0,\n        },\n    },\n    noRulesText: {\n        fontSize: 24,\n        color: theme.palette.primary.light\n    },\n    header: {\n        backgroundColor: theme.palette.secondary.main,\n        fontSize: 18,\n        fontWeight: 'bold',\n        paddingLeft: 40,\n        zIndex: 0,\n        color: '#FFF',\n    },\n    inputOid: {\n        width: 'calc(100% - 60px)',\n        display: 'inline-block'\n    },\n    inputOidButton: {\n        minWidth: 40,\n        display: 'inline-block',\n        marginLeft: 8\n    },\n    textField: {\n        width: 'calc(100% - 12px)',\n    },\n    rowPadding: {\n        marginBottom: theme.spacing(1),\n    }\n});\n\nclass RuleEditor extends PureComponent {\n    defaultState = {\n        words: I18n.t('Create Rule'),\n        name: I18n.t('Create Rule'),\n        _break: false,\n        editable: false,\n        args: [\n            {\n                default: I18n.t('Argument') + ' 1',\n            },\n            {\n                default: I18n.t('Argument') + ' 2',\n            },\n        ],\n        ack: {\n            name: '',\n            default: `${I18n.t('Confirmation text')}`,\n        },\n        id: 0,\n    };\n\n    state = {\n        localRule: null,\n        showDialog: false,\n        editIndex: 0,\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if ((!props.selectedRule && state.localRule) ||\n            (props.selectedRule && !state.localRule) ||\n            (props.selectedRule?.id !== state.localRule?.id)) {\n            return {\n                localRule: {...props.selectedRule}\n            };\n        } else {\n            return null;\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (\n            prevProps.selectedRule?.name !== this.props.selectedRule?.name ||\n            prevState.localRule?.name !== this.state.localRule?.name\n        ) {\n            if (!this.props.selectedRule || !this.props.selectedRule.name) {\n                this.setState({\n                    localRule: null,\n                });\n            } else {\n                this.setState({\n                    localRule: {\n                        ...this.props.selectedRule,\n                    },\n                });\n            }\n        } else if (this.state.isLocalStateWasUpdated) {\n            const unsavedRule = this.props.unsavedRules[this.state.localRule.id];\n\n            if (\n                isEqual(this.props.selectedRule, this.state.localRule) &&\n                !unsavedRule?.wasChangedGlobally\n            ) {\n                this.setState({isLocalStateWasUpdated: false});\n\n                if (!unsavedRule?.wasChangedGlobally) {\n                    this.props.removeUnsavedRule(this.state.localRule.id);\n                }\n            } else if (!unsavedRule && !this.props.pendingSelectedRuleId) {\n                this.props.setUnsavedRule(this.state.localRule.id);\n            }\n        } else if (\n            !this.state.isLocalStateWasUpdated &&\n            this.props.unsavedRules[this.state.localRule.id]\n        ) {\n            this.setState({isLocalStateWasUpdated: true});\n        }\n\n        if (this.props.pendingSelectedRuleId && this.state.isLocalStateWasUpdated) {\n            if (this.props.pendingSelectedRuleId === this.state.localRule.id) {\n                return;\n            }\n            this.setState({confirmChanges: true});\n        }\n\n        if (this.props.lang !== prevProps.lang) {\n            this.forceUpdate();\n        }\n    }\n\n    componentDidMount() {\n        if (!this.state.localRule && this.props.selectedRule) {\n            this.setState({\n                localRule: this.props.selectedRule,\n            });\n        }\n    }\n\n    createConfirmModalActions = () => {\n        const { t } = I18n;\n        const {\n            updateConfig,\n            classes,\n            selectRule,\n            pendingSelectedRuleId,\n            clearStateOnConfirmModalUnmount,\n            revertChangesFromConfig,\n        } = this.props;\n        const { localRule } = this.state;\n\n        const cancelSavingChanges = async () => {\n            await clearStateOnConfirmModalUnmount();\n            this.closeConfirmDialog();\n        };\n\n        const dontSaveAndGo = async () => {\n            await revertChangesFromConfig(localRule);\n            await selectRule(pendingSelectedRuleId);\n            await clearStateOnConfirmModalUnmount(localRule.id);\n\n            this.closeConfirmDialog();\n        };\n        const handleSaveAndGo = async () => {\n            await updateConfig(localRule);\n            await selectRule(pendingSelectedRuleId);\n            await clearStateOnConfirmModalUnmount();\n\n            this.closeConfirmDialog();\n        };\n        return <FormControl className={classes.submitForm}>\n            <div style={{flexGrow: 1}}/>\n            <Button\n                variant=\"contained\"\n                onClick={handleSaveAndGo}\n                color=\"primary\"\n                startIcon={<CheckIcon/>}\n                className={classes.saveAndGoBtn}>\n                {t('Save and go')}\n            </Button>\n            <Button onClick={dontSaveAndGo} variant=\"contained\" color=\"secondary\"\n                    startIcon={<CheckIcon/>}\n            >\n                {t(`Don't save and go`)}\n            </Button>\n            <Button\n                variant=\"contained\"\n                className={classes.btnDanger}\n                startIcon={<CloseIcon/>}\n                onClick={cancelSavingChanges}>\n                {t('Cancel')}\n            </Button>\n        </FormControl>;\n    };\n\n    createSaveSettingsForm = () => {\n        const { t } = I18n;\n        const { updateConfig, classes, revertChangesFromConfig, selectedRule } = this.props;\n        const { localRule } = this.state;\n\n        const handleSave = async () => {\n            await updateConfig(localRule);\n            this.setState({isLocalStateWasUpdated: false});\n        };\n\n        const revertChanges = async () => {\n            await revertChangesFromConfig(localRule);\n\n            await this.setState({\n                localRule: selectedRule,\n                isLocalStateWasUpdated: false,\n            });\n        };\n\n        if (!this.state.isLocalStateWasUpdated) {\n            return <div className={this.props.classes.emptyButtons} />;\n        } else {\n            return <FormControl className={classes.submitForm}>\n                <div style={{flexGrow: 1}}/>\n                <Button\n                    onClick={handleSave}\n                    variant=\"contained\"\n                    startIcon={<CheckIcon/>}\n                    color=\"primary\">\n                    {t('Save')}\n                </Button>\n                <Button\n                    variant=\"contained\"\n                    className={classes.btnDanger}\n                    startIcon={<CloseIcon/>}\n                    onClick={revertChanges}>\n                    {t('Cancel')}\n                </Button>\n            </FormControl>;\n        }\n    };\n\n    closeConfirmDialog = () => {\n        this.setState({\n            isLocalStateWasUpdated: false,\n            confirmChanges: false,\n        });\n    };\n\n    createInput = ({\n        value,\n        label,\n        onChange,\n        type,\n        onOpenSelectDialog,\n        note,\n        disabled = !this.state.localRule,\n        keywords,\n        key,\n        onSwitchChange,\n        isMobile,\n    }) => {\n        if ((value === undefined || value === null) && !label && !keywords) {\n            return null;\n        }\n        const { classes } = this.props;\n\n        if (onOpenSelectDialog) {\n            return <div>\n                <TextField\n                    classes={{root: classes.inputOid}}\n                    fullWidth\n                    label={isMobile ? label : ''}\n                    //variant=\"outlined\"\n                    size=\"small\"\n                    disabled={disabled}\n                    value={value}\n                    helperText={note || ''}\n                    onChange={onChange}\n                    key={key}\n                />\n                <Button\n                    onClick={() => onOpenSelectDialog(value)}\n                    size=\"small\"\n                    className={classes.inputOidButton}\n                    variant=\"outlined\"\n                >...</Button>\n            </div>\n        } else if (type !== 'checkbox') {\n            return <TextField\n                classes={{root: classes.textField}}\n                label={isMobile ? label : ''}\n                //variant=\"outlined\"\n                size=\"small\"\n                disabled={disabled}\n                value={value}\n                helperText={note || ''}\n                onChange={onChange}\n                key={key}\n                className={classes.rowPadding}\n                type={type === 'number' ? 'number' : 'text'}\n                //className={clsx('outlined-basic', classes.textField)}\n            />;\n        } else {\n            return <FormControl classes={{ root: classes.switchControl }}>\n                <Switch\n                    key={key}\n                    onClick={onSwitchChange}\n                    color={'primary'}\n                    disabled={disabled}\n                    checked={!!value}\n                />\n                {isMobile ? <FormLabel>{label}</FormLabel> : null}\n            </FormControl>;\n        }\n    };\n\n    createOptionsData = (state = this.state) => {\n        const {localRule: { args, ack, editable, _break }} = state;\n        const { t } = I18n;\n\n        const createInput = this.createInput;\n        const handlers = this.handlers;\n\n        const isKeyWordsDisabled = () => {\n            if (editable === undefined) {\n                return false;\n            } else if (editable === false) {\n                return true;\n            }\n            return false;\n        };\n\n        return [\n            {\n                title: t('Keywords'),\n                item: createInput({\n                    value: this.state.localRule?.words || '',\n                    onChange: handlers.keywordsText,\n                    keywords: true,\n                    disabled: isKeyWordsDisabled(),\n                    key: 'keywords',\n                    label: t('Keywords'),\n                    isMobile: this.props.isMobile,\n                }),\n                id: 1,\n            },\n            {\n                title: t('Interrupt processing'),\n                item: createInput({\n                    type: 'checkbox',\n                    value: _break,\n                    onSwitchChange: handlers.breakOnSwitch,\n                    key: 'break',\n                    label: t('Interrupt processing'),\n                    isMobile: this.props.isMobile,\n                }),\n                id: 2,\n            },\n            {\n                title: args && args[0]?.name, //`${t('Argument')}:`,\n                item: createInput({\n                    value: args && this.state.localRule.args[0]?.default,\n                    type: args && args[0]?.type,\n                    onOpenSelectDialog: selectedId => this.openSelectIdDialog(args && args[0], selectedId, 0),\n                    onSwitchChange: handlers.param1OnSwitch,\n                    key: 'Param1',\n                    label: args && args[0]?.name, //`${t('Argument')}:`,\n                    isMobile: this.props.isMobile,\n                }),\n                id: 3,\n            },\n            {\n                title: args && args[1]?.name, //`${t('Argument')}:`,\n                item: createInput({\n                    value: args && this.state.localRule.args[1]?.default,\n                    type: args && args[1]?.type,\n                    onChange: handlers.param2Text,\n                    onSwitchChange: handlers.param2OnSwitch,\n                    key: 'Param2',\n                    label: args && args[1]?.name, //`${t('Argument')}:`,\n                    isMobile: this.props.isMobile,\n                }),\n                id: 4,\n            },\n            {\n                title: args && args[2]?.name, //`${t('Argument')}:`,\n                item: createInput({\n                    value: args && this.state.localRule.args[2]?.default,\n                    type: args && args[2]?.type,\n                    onOpenSelectDialog: selectedId => this.openSelectIdDialog(args && args[2], selectedId, 2),\n                    onSwitchChange: handlers.param3OnSwitch,\n                    key: 'Param3',\n                    label: args && args[2]?.name, //`${t('Argument')}:`,\n                    isMobile: this.props.isMobile,\n                }),\n                id: 5,\n            },\n            {\n                title: t('Confirmation text'),\n                item: createInput({\n                    value: ack && ack.default,\n                    //label: ack && ack.name,\n                    note: t('You can use %s, that will be replaced with current value of state. %u will be replaced by unit'),\n                    type: ack && ack.type,\n                    key: 'confirmationText',\n                    onChange: handlers.confirmText,\n                    onSwitchChange: handlers.confirmOnSwitch,\n                    label: t('Confirmation text'),\n                    isMobile: this.props.isMobile,\n                }),\n                id: 6,\n            },\n        ];\n    };\n\n    createInputHandlers = () => {\n        const _this = this;\n\n        return {\n            keywordsText(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        words: event.target.value,\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param2Text(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index > 0\n                                ? {\n                                      ...arg,\n                                      default: event.target.value,\n                                  }\n                                : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            confirmText(event) {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        ack: {\n                            ..._this.state.localRule.ack,\n                            default: event.target.value,\n                        },\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param1OnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index === 0 ? { ...arg, default: !arg.default ? true : !arg.default } : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param2OnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index === 1 ? { ...arg, default: !arg.default ? true : !arg.default } : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            param3OnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        args: _this.state.localRule.args.map((arg, index) =>\n                            index === 2 ? { ...arg, default: !arg.default ? true : !arg.default } : arg\n                        ),\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            confirmOnSwitch() {\n                _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        ack: {\n                            ..._this.state.localRule.ack,\n                            default: !_this.state.localRule.ack.default,\n                        },\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n            async breakOnSwitch() {\n                await _this.setState({\n                    localRule: {\n                        ..._this.state.localRule,\n                        _break: !_this.state.localRule._break,\n                    },\n                    isLocalStateWasUpdated: true,\n                });\n            },\n        };\n    };\n\n    handlers = this.createInputHandlers();\n\n    openSelectIdDialog = (arg, selectedId, editIndex) => {\n        if (arg.type === 'id') {\n            this.setState({showDialog: true, showDialogId: selectedId, editIndex});\n        }\n    };\n\n    onIDSelected = selected => {\n        this.setState({\n            localRule: {\n                ...this.state.localRule,\n                args: this.state.localRule.args.map((arg, index) =>\n                    index === this.state.editIndex\n                        ? {\n                              ...arg,\n                              default: selected,\n                          }\n                        : arg\n                ),\n            },\n            isLocalStateWasUpdated: true,\n            editIndex: 0\n        });\n    };\n\n    renderConfirmDialog() {\n        return this.state.confirmChanges ? (\n            <Dialog fullWidth open={this.state.confirmChanges} maxWidth={'md'}>\n                <DialogTitle>\n                    {I18n.t('Please confirm or cancel changes before leaving')}\n                </DialogTitle>\n                <DialogContent>\n                    <Typography>\n                        {I18n.t('You have changed rule') + ': '}{' '}\n                        <strong>{this.state.localRule.name}</strong>\n                    </Typography>\n                    <DialogActions>{this.createConfirmModalActions()}</DialogActions>\n                </DialogContent>\n            </Dialog>\n        ) : null;\n    }\n\n    renderSelectIdDialog() {\n        return this.state.showDialog ?\n            <DialogSelectID\n                imagePrefix={'../..'}\n                socket={this.props.socket}\n                title={'Select ID'}\n                selected={this.state.showDialogId}\n                onClose={() => this.setState({ showDialog: false})}\n                onOk={id => this.onIDSelected(id)}\n            />: null;\n    }\n\n    render() {\n        const {localRule} = this.state;\n\n        const { classes, isLeftBarOpen, toggleLeftBar } = this.props;\n        const name = localRule ? localRule.name : '';\n\n        if (!this.props.selectedRule) {\n            return null;\n        }\n\n        return <div className={classes.root}>\n            <Box className={classes.toggleIcon} onClick={toggleLeftBar}>\n                {isLeftBarOpen || this.props.isMobile ? <MenuIcon /> : <ArrowBackIcon />}\n            </Box>\n            <Toolbar position=\"static\" variant=\"dense\" className={this.props.classes.header}>\n                {name}\n            </Toolbar>\n\n            <Box className={clsx(classes.box, this.props.isMobile ? classes.boxMobile : classes.boxDesktop)} key={this.props.selectedRule ? this.props.selectedRule.id : 'emptyLeft'}>\n                {localRule ?\n                    <Paper className={classes.container}>\n                        <div style={this.props.isMobile ? {width: '100%'} : {display: 'grid', gridTemplateColumns: 'minmax(50px, 265px) 1fr'}}>\n                            {this.createOptionsData().map(({title, item, id}) => {\n                                if (!item) {\n                                    return null;\n                                }\n\n                                return [\n                                    !this.props.isMobile ?<div key={1} className={clsx(classes.title, classes.rowSpace)}>{title}</div> : null,\n                                    <div key={2} className={classes.rowSpace}>{item}</div>\n                                ];\n                            })}\n                        </div>\n                    </Paper>\n                    :\n                    null\n                }\n\n                {this.renderSelectIdDialog()}\n                {this.renderConfirmDialog()}\n            </Box>\n\n            {localRule ? <Toolbar position=\"static\" variant=\"dense\" className={this.props.classes.header}>\n                {this.createSaveSettingsForm()}\n            </Toolbar> : null}\n\n        </div>;\n    }\n}\n\nexport default withStyles(styles)(RuleEditor);\n\nRuleEditor.propTypes = {\n    selectedRule: PropTypes.shape({\n        name: PropTypes.string,\n        id: PropTypes.string,\n        rule: PropTypes.string,\n        ack: PropTypes.shape({\n            default: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n            value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n        }),\n        arg: PropTypes.arrayOf(\n            PropTypes.shape({\n                name: PropTypes.string,\n                type: PropTypes.string,\n                default: PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.bool]),\n            })\n        ),\n        words: PropTypes.string,\n    }).isRequired,\n    socket: PropTypes.object.isRequired,\n    updateConfig: PropTypes.func.isRequired,\n    revertChangesFromConfig: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n    selectRule: PropTypes.func.isRequired,\n    pendingSelectedRuleId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n    clearStateOnConfirmModalUnmount: PropTypes.func.isRequired,\n    unsavedRules: PropTypes.object.isRequired,\n    setUnsavedRule: PropTypes.func.isRequired,\n    removeUnsavedRule: PropTypes.func.isRequired,\n    toggleLeftBar: PropTypes.func.isRequired,\n    isLeftBarOpen: PropTypes.bool,\n    isMobile: PropTypes.bool.isRequired,\n};\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControl from '@material-ui/core/FormControl';\nimport { DialogActions, Button, Select, TextField, MenuItem, withStyles } from '@material-ui/core';\n\nimport CheckIcon from '@material-ui/icons/Check';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nconst styles = theme => ({\n    select: {\n        width: '100%',\n        marginBottom: theme.spacing(2.5),\n    },\n    TextField: {\n        marginBottom: theme.spacing(1),\n    },\n});\n\nclass CreateRuleDialog extends Component {\n    defaultRule = {\n        rule: I18n.t('Select rule'),\n        name: I18n.t('New rule'),\n        id: '',\n    };\n\n    state = {\n        localRule: this.defaultRule,\n        isDisabled: true,\n    };\n\n    componentWillUnmount() {\n        this.cleanState();\n    }\n\n    setRuleOnMount = () => {\n        const { isEdit, selectedRule } = this.props;\n        if (isEdit) {\n            this.setState({\n                localRule: selectedRule,\n            });\n        }\n    };\n\n    cleanState = () => {\n        if (this.props.isEdit && !this.props.isCopy) {\n            this.props.finishEdit(this.state.localRule);\n        }\n        this.setState({localRule: this.defaultRule});\n    };\n\n    getAvailableOptions = () => {\n        const { commands, rules, selectedRule, isEdit } = this.props;\n\n        const uniqueOptions = commands?.filter(\n            option => !(option.unique && rules.find(item => item?.rule === option.rule))\n        );\n\n        return selectedRule?.unique && isEdit ? uniqueOptions.concat(selectedRule) : uniqueOptions;\n    };\n\n    getUniqueName = ruleName => {\n        const existingNames = this.props.rules?.map(rule => rule?.name);\n\n        const matchingNames = existingNames.filter(\n            name => name.slice(0, name.length - 2) === ruleName\n        );\n        const isUnique = this.props.commands.find(\n            ({ rule, unique }) => rule === ruleName && unique\n        );\n\n        if (matchingNames.length) {\n            let name = matchingNames[matchingNames.length - 1];\n            let lastChar = name.slice(name.length - 1);\n\n            return name.slice(0, name.length - 1) + ++lastChar;\n        }\n\n        return isUnique ? ruleName : `${ruleName} 1`;\n    };\n\n    createForm = disabled => {\n        const { localRule } = this.state;\n        const { classes } = this.props;\n        const commands = this.getAvailableOptions();\n        const onSubmitHandler = !this.props.isEdit ? this.props.handleSubmitOnCreate : (this.props.isCopy ? this.props.handleSubmitOnCopy : this.props.handleSubmitOnEdit);\n\n        const handleSelectChange = event =>\n            this.setState({\n                localRule: {\n                    ...localRule,\n                    rule: event.target.value,\n                    name: this.getUniqueName(event.target.value),\n                    isError: '',\n                },\n            });\n\n        const handleInputChange = event => {\n            const existingNames = this.props.rules?.map(rule => rule?.name);\n\n            this.setState({\n                localRule: {\n                    ...localRule,\n                    name: event.target.value,\n                    isError: existingNames.includes(event.target.value)\n                        ? `${I18n.t('Name already exist')}`\n                        : '',\n                },\n            });\n        };\n\n        return <FormGroup>\n            {!this.props.isCopy ? <FormControl fullWidth>\n                <InputLabel shrink id=\"rule\">\n                    {I18n.t('Rule')}\n                </InputLabel>\n                <Select\n                    onChange={handleSelectChange}\n                    value={localRule.rule}\n                    labelId={'rule'}\n                    className={classes.select}>\n                    {commands?.map(option =>\n                        <MenuItem key={option.rule} value={option.rule}>\n                            {option.rule}\n                        </MenuItem>\n                    )}\n                </Select>\n            </FormControl> : null}\n            <TextField\n                fullWidth\n                autoFocus\n                id=\"standard-basic\"\n                label={this.state.localRule.isError || I18n.t('Name')}\n                value={localRule.name}\n                onKeyDown={e => {\n                    if (e.keyCode === 13 && !disabled) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        onSubmitHandler(\n                            this.state.localRule,\n                            this.state.localRule.isError\n                        );\n                    }\n                }}\n                onChange={handleInputChange}\n                error={!!this.state.localRule.isError}\n                className={classes.TextField}/>\n        </FormGroup>;\n    };\n\n    setDialogContent = () => {\n        const { handleClose, handleSubmitOnCreate, handleSubmitOnEdit, isEdit, isCopy, handleSubmitOnCopy } = this.props;\n        const onSubmitHandler = !isEdit ? handleSubmitOnCreate : (isCopy ? handleSubmitOnCopy : handleSubmitOnEdit);\n        const disabled = !this.state.localRule.name || !this.state.localRule.rule || (this.state.localRule.name === this.defaultRule.name && this.state.localRule.rule === this.defaultRule.rule) ||\n        (this.state.localRule.name === this.props.selectedRule?.name && this.state.localRule.rule === this.props.selectedRule?.rule);\n        return <DialogContent>\n            {this.createForm(disabled, onSubmitHandler)}\n            <DialogActions>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={() => onSubmitHandler(\n                        this.state.localRule,\n                        this.state.localRule.isError\n                    )}\n                    startIcon={<CheckIcon/>}\n                    disabled={disabled}>\n                    { I18n.t('Ok') }\n                </Button>\n                <Button variant=\"contained\" onClick={handleClose} startIcon={<CloseIcon/>}>{I18n.t('Cancel')}</Button>\n            </DialogActions>\n        </DialogContent>;\n    };\n\n    render() {\n        return <Dialog\n            open={this.props.isOpen}\n            onClose={this.props.handleClose}\n            onExited={this.cleanState}\n            onEnter={this.setRuleOnMount}\n            fullWidth>\n            <DialogTitle>\n                {I18n.t(!this.props.isEdit ? 'Create new rule' : (this.props.isCopy ? 'Clone rule' : 'Edit rule'))}\n            </DialogTitle>\n            {this.setDialogContent()}\n        </Dialog>;\n    }\n}\n\nexport default withStyles(styles)(CreateRuleDialog);\n\nCreateRuleDialog.propTypes = {\n    handleClose: PropTypes.func.isRequired,\n    handleSubmitOnCreate: PropTypes.func.isRequired,\n    handleSubmitOnEdit: PropTypes.func.isRequired,\n    handleSubmitOnCopy: PropTypes.func.isRequired,\n    isEdit: PropTypes.bool.isRequired,\n    commands: PropTypes.arrayOf(\n        PropTypes.shape({\n            rule: PropTypes.string.isRequired,\n            unique: PropTypes.bool.isRequired,\n        }).isRequired\n    ),\n    isOpen: PropTypes.bool.isRequired,\n    selectedRule: PropTypes.shape({\n        id: PropTypes.string.isRequired,\n        name: PropTypes.string.isRequired,\n        rule: PropTypes.string.isRequired,\n        unique: PropTypes.bool,\n    }),\n    rules: PropTypes.arrayOf(\n        PropTypes.shape({\n            id: PropTypes.string.isRequired,\n            name: PropTypes.string.isRequired,\n            rule: PropTypes.string.isRequired,\n            unique: PropTypes.bool,\n        })\n    ).isRequired,\n    finishEdit: PropTypes.func.isRequired,\n    classes: PropTypes.object.isRequired,\n};\n","import React, { PureComponent } from 'react';\nimport SplitterLayout from 'react-splitter-layout';\nimport { v4 as uuid } from 'uuid';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { withStyles } from '@material-ui/core/styles';\nimport withWidth from '@material-ui/core/withWidth';\nimport 'react-splitter-layout/lib/index.css';\n\nimport Drawer from '@material-ui/core/Drawer';\n\nimport I18n from '@iobroker/adapter-react/i18n';\n\nimport DrawerComponent from './Drawer';\nimport RuleEditor from './RuleEditor';\nimport CreateRuleDialog from './CreateRuleDialog';\nimport isEqual from 'lodash.isequal';\n\nconst styles = theme => ({\n    layout: {\n        '& .layout-pane:first': {\n            overflow: 'hidden',\n        },\n    },\n    hidden: {\n        '& .layout-pane:first-child': {\n            width: '0 !important',\n        },\n        background: theme.palette.background.default,\n    },\n    opened: {\n        '& .layout-pane-primary': {\n            width: '',\n        },\n        overflow: 'hidden',\n        background: theme.palette.background.default,\n    },\n    noRulesText: {\n        fontSize: 24,\n        color: theme.palette.primary.light,\n        textAlign: 'center',\n        paddingTop: theme.spacing(2),\n    },\n});\n\nclass Layout extends PureComponent {\n    constructor(props) {\n        super(props);\n\n        this.menuSize = parseFloat(window.localStorage.getItem('App.menuSize')) || 350;\n        this.state = {\n            rules: [],\n            isOpen: false,\n            isEdit: false,\n            isCopy: false,\n            selectedRule: null,\n            unsavedRules: {},\n            ready: false,\n            isLeftBarOpen: window.localStorage.getItem('App.menuHidden') === 'true',\n        };\n        this.commands = this.getSelectedLanguageCommands();\n        this.isMobile = this.props.width === 'sm' || this.props.width === 'xs';\n    }\n\n    componentDidMount() {\n        this.getDataFromConfig()\n            .then(({ rules, ...settings }) => {\n                const rulesWithId = rules.map(rule =>\n                    !rule.id || !rule.name\n                        ? {\n                              ...rule,\n                              id: rule.id || uuid(),\n                              name: rule.name || window.commands[rule.template]?.name[I18n.getLanguage()] || window.commands[rule.template]?.name.en,\n                          }\n                        : rule\n                );\n\n                if (!isEqual(rules, rulesWithId)) {\n                    this.props.saveConfig({ rules: rulesWithId, ...settings });\n                    setTimeout(() => this.setState({rules: rulesWithId}), 50);\n                }\n            });\n\n        if (this.isMobile) {\n            this.setState({isLeftBarOpen: true});\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.settings?.language !== this.state.lang && this.state.settings?.language) {\n            const lang = this.state.settings?.language;\n            I18n.setLanguage(lang);\n\n            this.commands = this.getSelectedLanguageCommands();\n        }\n\n        if (\n            prevState.selectedRule?.id !== this.state.selectedRule?.id &&\n            prevState.selectedRule?.id && this.state.selectedRule\n        ) {\n            localStorage.setItem('selectedRule', this.state.selectedRule.id);\n        }\n    }\n\n    getSelectedLanguageCommands = () => {\n        const lang = this.state?.settings?.language || I18n.getLanguage();\n\n        return [\n            { rule: I18n.t('Select rule'), unique: false },\n            ...Object.entries(window.commands).map(item => {\n                const [key, command] = item;\n                const { name, ...rest } = command;\n                const obj = {\n                    ...rest,\n                    rule: command?.name[lang],\n                    template: key,\n                    unique: command.unique,\n                    words: command.words && command.words[lang],\n                    args: command.args?.map(arg => ({\n                        ...arg,\n                        name: arg.name[lang] || '',\n                        default: arg.default !== undefined ? arg.default : (arg.type === 'checkbox' ? false : ''),\n                    })),\n                    ack: command.ack && {\n                        ...command.ack,\n                        name: command.ack.name[lang],\n                        default: !command.ack?.default\n                            ? command.ack?.type === 'checkbox'\n                                ? false\n                                : ''\n                            : command.ack.default[lang],\n                    },\n                };\n\n                return obj;\n            }),\n        ];\n    };\n\n    commands = this.getSelectedLanguageCommands();\n\n    moveRule = (dragIndex, hoverIndex) => {\n        const { rules } = this.state;\n        const sourceRule = rules.find((_, index) => index === hoverIndex);\n        const sortRules = rules.filter((_, index) => index !== hoverIndex);\n        sortRules.splice(dragIndex, 0, sourceRule);\n        this.setState({ rules: sortRules });\n    };\n\n    handleOpen = add => {\n        if (add) {\n            this.setState({isEdit: false, isCopy: false, isOpen: true});\n        } else {\n            this.setState({isOpen: true,});\n        }\n    };\n\n    handleClose = () => {\n        this.setState({ isOpen: false });\n    };\n\n    handleSubmitOnCreate = (selectedRule, isError) => {\n        if (isError) {\n            return;\n        }\n\n        const id = uuid();\n        const shortDataRule = {\n            ...selectedRule,\n            id,\n            _break: true,\n        };\n\n        const rule = {\n            ...this.commands.find(command => command.rule === shortDataRule.rule),\n            ...shortDataRule,\n        };\n        const isUnsavedChanges = Object.values(this.state.unsavedRules).length;\n\n        this.setState(\n            {\n                rules: [...this.state.rules, rule],\n                unsavedRules: {\n                    ...this.state.unsavedRules,\n                    [id]: {\n                        id,\n                        wasChangedGlobally: true,\n                    },\n                },\n                selectedRule: !isUnsavedChanges ? rule : this.state.selectedRule,\n            },\n            () => {\n                if (isUnsavedChanges) {\n                    this.selectRule(rule.id);\n                }\n            }\n        );\n\n        this.handleClose();\n    };\n\n    handleSubmitOnEdit = (selectedRule, isError) => {\n        if (isError) {\n            return;\n        }\n\n        const unsavedRules = JSON.parse(JSON.stringify(this.state.unsavedRules));\n        unsavedRules[selectedRule.id] = { id: selectedRule.id, wasChangedGlobally: true};\n\n        this.setState({\n            unsavedRules,\n            rules: this.updateRule(selectedRule),\n        });\n        this.handleClose();\n    };\n\n    handleSubmitOnCopy = (selectedRule, isError) => {\n        if (isError) {\n            return;\n        }\n\n        const newRule = JSON.parse(JSON.stringify(selectedRule));\n        newRule.id = uuid();\n\n        const rules = JSON.parse(JSON.stringify(this.state.rules));\n        rules.push(newRule);\n\n        const unsavedRules = JSON.parse(JSON.stringify(this.state.unsavedRules));\n        unsavedRules[newRule.id] = {id: newRule.id, wasChangedGlobally: true};\n\n        this.setState({\n                rules,\n                unsavedRules,\n                selectedRule: newRule,\n                isOpen: false\n            },\n            () => {\n                this.selectRule(newRule.id);\n            }\n        );\n    };\n\n    selectRule = id => {\n        const { selectedRule, rules } = this.state;\n\n        if (selectedRule.id === id) {\n            // ignore\n            if (this.isMobile) {\n                this.setState({isLeftBarOpen: false});\n            }\n        } else if (this.state.unsavedRules[selectedRule.id]) {\n            this.setState({\n                pendingSelectedRuleId: id,\n            });\n        } else {\n            const rule = rules.find(item => item.id === id);\n\n            this.setState({\n                selectedRule: rule,\n                isLeftBarOpen: this.isMobile ? false : this.state.isLeftBarOpen\n            });\n        }\n    };\n\n    updateRule = selectedRule => {\n        const rules = JSON.parse(JSON.stringify(this.state.rules));\n\n        const item = rules.find(item => item.id === selectedRule.id);\n        rules[rules.indexOf(item)] = selectedRule;\n\n        return rules;\n    };\n\n    handleEdit = () => {\n        this.setState({isEdit: true, isCopy: false}, () =>\n            this.handleOpen());\n    };\n\n    handleCopy = () => {\n        this.setState({isCopy: true, isEdit: true}, () =>\n            this.handleOpen());\n    };\n\n    finishEdit = editableRule => {\n        let selectedRule;\n\n        const { rule, id, name, _break, template } = editableRule;\n\n        // if rule was updated => apply fields\n        if (this.state.selectedRule.rule !== rule) {\n            const updatedRuleOptions = this.commands.find(command => command.rule === rule);\n\n            selectedRule = {\n                ...updatedRuleOptions,\n                name,\n                rule,\n                id,\n                _break,\n                template,\n            };\n        } else {\n            selectedRule = JSON.parse(JSON.stringify(editableRule));\n        }\n\n        const rules = JSON.parse(JSON.stringify(this.state.rules));\n        const _rule = rules.find(it => it.id === selectedRule.id);\n        if (_rule) {\n            rules[rules.indexOf(_rule)] = selectedRule;\n        } else {\n            rules.push(selectedRule);\n        }\n\n        this.setState({\n            isEdit: false,\n            isCopy: false,\n            rules,\n            selectedRule,\n        });\n    };\n\n    removeRule = id => {\n        const rules = this.state.rules.filter(rule => rule.id !== id);\n\n        this.setState(\n            {\n                rules,\n                selectedRule: rules.length ? rules[rules.length - 1] : null,\n            },\n            () => {\n                this.props.readConfig()\n                    .then(config => {\n                        const { rules, ...settings } = config;\n                        const newConfig = { rules: rules.filter(rule => rule.id !== id), ...settings };\n                        this.props.saveConfig(newConfig);\n                    });\n            });\n    };\n\n    updateConfig = async currentSelectedRule => {\n        const { [currentSelectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\n        const config = await this.props.readConfig();\n        const { rules, ...settings } = config;\n\n        const matchingRule = rules.find(rule => rule.id === currentSelectedRule.id);\n        const updatedCurrentRules = this.updateRule(currentSelectedRule)\n\n        let updatedRules;\n        if (matchingRule) {\n            updatedRules = rules.map(rule =>\n                rule.id === currentSelectedRule.id\n                    ? this.getRuleShortData(currentSelectedRule)\n                    : rule\n            );\n        } else {\n            updatedRules = [...rules, this.getRuleShortData(currentSelectedRule)];\n        }\n\n        const newConfig = { rules: updatedRules, ...settings };\n        await this.props.saveConfig(newConfig);\n\n        this.setState({\n            selectedRule: currentSelectedRule || this.state.selectedRule || null,\n            rules: updatedCurrentRules,\n            unsavedRules: ids,\n        });\n    };\n\n    getDataFromConfig = () => {\n        return this.props.readConfig()\n            .then(config => {\n                const { rules, ...settings } = config;\n                const lang = I18n.getLanguage();\n\n                const currentRules = rules.map(rule => {\n                    const obj = window.commands[rule?.template];\n\n                    if (!obj) {\n                        window.alert(`Unknown rule: \"${rule?.template}\". Please report an issue on Github!`);\n                        return null;\n                    }\n\n                    return {\n                        ...obj,\n                        rule: obj?.name[lang],\n                        ack: {\n                            ...obj.ack,\n                            default: rule.ack || (obj.ack?.type === 'checkbox' ? false : ''),\n                            name: obj.ack?.name[lang],\n                        },\n                        args: obj.args?.map((arg, index) => ({\n                            ...arg,\n                            default: rule.args[index] || (arg?.type === 'checkbox' ? false : ''),\n                            name: arg?.name[lang] || '',\n                        })),\n                        name: rule.name || obj?.name[lang],\n                        words: rule.words,\n                        _break: rule._break,\n                        id: rule.id || uuid(),\n                        template: rule.template,\n                    };\n                })\n                    .filter(rule => rule);\n\n                this.setState({\n                    rules: currentRules,\n                    ready: true,\n                    selectedRule:\n                        currentRules.find(rule => rule.id === localStorage.getItem('selectedRule')) ||\n                        currentRules[currentRules.length - 1] ||\n                        null,\n                    settings,\n                });\n\n                return config;\n            });\n    };\n\n    revertChangesFromConfig = async selectedRule => {\n        const actualRules = this.state.rules;\n        const { [selectedRule.id]: removedId, ...ids } = this.state.unsavedRules;\n        const config = await this.props.readConfig();\n        const { rules, ...settings } = config;\n\n        const matchingRule = rules.find(rule => rule.id === selectedRule.id);\n        const isRuleWasUpdatedGlobally = this.state.unsavedRules[selectedRule.id]\n            ?.wasChangedGlobally;\n\n        let updatedRules;\n        if (matchingRule && isRuleWasUpdatedGlobally) {\n            updatedRules = actualRules.map(rule =>\n                rule.id === matchingRule.id\n                    ? {\n                          ...rule,\n                          ack: {\n                              ...rule.ack,\n                              default: matchingRule.ack || '',\n                          },\n                          args: rule.args?.map(arg => ({\n                              ...arg,\n                              default: matchingRule.arg || '',\n                          })),\n                          rule: window.commands[matchingRule.template].name[I18n.getLanguage()],\n                          words: matchingRule.words || '',\n                          name: matchingRule.name || '',\n                          _break: matchingRule._break || true,\n                      }\n                    : rule\n            );\n        } else if (!matchingRule) {\n            updatedRules = actualRules.filter(rule => rule.id !== selectedRule.id);\n        }\n\n        const newState = {\n            rules: updatedRules || actualRules,\n            selectedRule:\n                (isRuleWasUpdatedGlobally\n                    ? updatedRules.find(rule => rule.id === selectedRule.id)\n                    : this.state.selectedRule) || null,\n            settings,\n            unsavedRules: ids,\n        };\n\n        if (this.state.rules.length !== newState.rules.length) {\n            newState.selectedRule = newState.rules[newState.rules.length - 1] || null;\n        }\n\n        this.setState(newState);\n    };\n\n    saveSettings = async (localeSettings, closeModal) => {\n        const config = await this.props.readConfig();\n        const { rules } = config;\n\n        const newConfig = { rules, ...localeSettings };\n        await this.props.saveConfig(newConfig);\n        this.setState({settings: localeSettings}, () =>\n            closeModal());\n    };\n\n    setUnsavedRule = id => {\n        this.setState({\n            unsavedRules: {\n                ...this.state.unsavedRules,\n                [id]: {\n                    id,\n                    wasChangedGlobally: false,\n                },\n            },\n        });\n    };\n\n    removeUnsavedRule = id => {\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\n        this.setState({\n            unsavedRules: ids,\n        });\n    };\n\n    getRuleShortData = ({ _break, template, words, ack, args, name, id }) => ({\n        words: words || '',\n        ack: ack?.default || '',\n        args: args?.map(arg => arg.default) || [],\n        _break,\n        template,\n        name,\n        id,\n    });\n\n    clearStateOnConfirmModalUnmount = id => {\n        const { [id]: removedId, ...ids } = this.state.unsavedRules;\n\n        this.setState({\n            pendingSelectedRuleId: false,\n            unsavedRules: ids,\n        });\n    };\n\n    toggleLeftBar = () => {\n        window.localStorage.setItem('App.menuHidden', !this.state.isLeftBarOpen);\n        this.setState({isLeftBarOpen: !this.state.isLeftBarOpen,});\n    };\n\n    closeDrawer = () => {\n        this.setState({isLeftBarOpen: false});\n    };\n\n    renderModalDialog() {\n        return this.state.isOpen ?\n            <CreateRuleDialog\n                key=\"modal\"\n                commands={this.commands}\n                isEdit={this.state.isEdit}\n                isCopy={this.state.isCopy}\n                handleSubmitOnCreate={this.handleSubmitOnCreate}\n                handleSubmitOnEdit={this.handleSubmitOnEdit}\n                handleSubmitOnCopy={this.handleSubmitOnCopy}\n                handleClose={this.handleClose}\n                isOpen={this.state.isOpen}\n                rules={this.state.rules}\n                selectedRule={this.state.selectedRule}\n                finishEdit={this.finishEdit}\n            />\n         : null;\n    }\n\n    render() {\n        console.log(this.state);\n        const { classes } = this.props;\n        const { rules, selectedRule, isLeftBarOpen } = this.state;\n\n        if (!this.state.ready) {\n            return null;\n        }\n\n        if (this.isMobile) {\n            return <React.Fragment>\n                <Drawer\n                    anchor=\"left\"\n                    open={this.state.isLeftBarOpen}\n                    onClose={this.closeDrawer}>\n                    <DrawerComponent\n                        themeType={this.props.themeType}\n                        handleOpen={this.handleOpen}\n                        rules={rules}\n                        moveRule={this.moveRule}\n                        handleEdit={this.handleEdit}\n                        handleCopy={this.handleCopy}\n                        selectRule={this.selectRule}\n                        selectedRule={selectedRule}\n                        removeRule={this.removeRule}\n                        settings={this.state.settings}\n                        socket={this.props.socket}\n                        saveSettings={this.saveSettings}\n                        theme={this.props.theme}\n                        toggleLeftBar={this.toggleLeftBar}\n                        unsavedRules={this.state.unsavedRules}\n                        isMobile={this.isMobile}\n                        closeDrawer={this.closeDrawer}\n                    />\n                </Drawer>\n                {this.state.settings && selectedRule ?\n                    <RuleEditor\n                        key={selectedRule.id}\n                        selectedRule={selectedRule}\n                        socket={this.props.socket}\n                        updateConfig={this.updateConfig}\n                        revertChangesFromConfig={this.revertChangesFromConfig}\n                        pendingSelectedRuleId={this.state.pendingSelectedRuleId}\n                        unsavedRules={this.state.unsavedRules}\n                        selectRule={this.selectRule}\n                        clearStateOnConfirmModalUnmount={this.clearStateOnConfirmModalUnmount}\n                        lang={this.state.settings.language}\n                        setUnsavedRule={this.setUnsavedRule}\n                        removeUnsavedRule={this.removeUnsavedRule}\n                        toggleLeftBar={this.toggleLeftBar}\n                        isLeftBarOpen={this.state.isLeftBarOpen}\n                        isMobile={this.isMobile}\n                    />\n                    :\n                    <div className={classes.noRulesText}>{I18n.t('Create a new rule with a \"+\" on the left')}</div>}\n\n                {this.renderModalDialog()}\n            </React.Fragment>;\n        } else {\n            return <React.Fragment>\n                <SplitterLayout\n                    key=\"splitterLayout\"\n                    customClassName={clsx(\n                        isLeftBarOpen ? classes.hidden : classes.opened,\n                        classes.layout\n                    )}\n                    primaryMinSize={350}\n                    primaryIndex={1}\n                    secondaryMinSize={350}\n                    onSecondaryPaneSizeChange={size => (this.menuSize = parseFloat(size))}\n                    onDragEnd={() => window.localStorage.setItem('App.menuSize', this.menuSize.toString())}\n                    secondaryInitialSize={this.menuSize}>\n                    <DrawerComponent\n                        handleOpen={this.handleOpen}\n                        rules={rules}\n                        moveRule={this.moveRule}\n                        handleEdit={this.handleEdit}\n                        handleCopy={this.handleCopy}\n                        selectRule={this.selectRule}\n                        selectedRule={selectedRule}\n                        removeRule={this.removeRule}\n                        instance={this.props.instance}\n                        settings={this.state.settings}\n                        socket={this.props.socket}\n                        saveSettings={this.saveSettings}\n                        theme={this.props.theme}\n                        unsavedRules={this.state.unsavedRules}\n                        isMobile={this.isMobile}\n                    />\n                    {this.state.settings && selectedRule ?\n                        <RuleEditor\n                            selectedRule={selectedRule}\n                            socket={this.props.socket}\n                            updateRule={this.updateRule}\n                            updateConfig={this.updateConfig}\n                            revertChangesFromConfig={this.revertChangesFromConfig}\n                            pendingSelectedRuleId={this.state.pendingSelectedRuleId}\n                            unsavedRules={this.state.unsavedRules}\n                            selectRule={this.selectRule}\n                            clearStateOnConfirmModalUnmount={this.clearStateOnConfirmModalUnmount}\n                            lang={this.state.settings.language}\n                            setUnsavedRule={this.setUnsavedRule}\n                            removeUnsavedRule={this.removeUnsavedRule}\n                            toggleLeftBar={this.toggleLeftBar}\n                            isLeftBarOpen={this.state.isLeftBarOpen}\n                            isMobile={this.isMobile}\n                        />\n                        :\n                        <div className={classes.noRulesText}>{I18n.t('Create a new rule with a \"+\" on the left')}</div>}\n                </SplitterLayout>\n                {this.renderModalDialog()}\n            </React.Fragment>;\n        }\n    }\n}\n\nLayout.propTypes = {\n    socket: PropTypes.object.isRequired,\n    theme: PropTypes.object.isRequired,\n    themeType: PropTypes.string,\n    instance: PropTypes.number.isRequired,\n    readConfig: PropTypes.func.isRequired,\n    saveConfig: PropTypes.func.isRequired,\n};\n\nexport default withStyles(styles)(withWidth()(Layout));\n","import React from 'react';\nimport isEqual from 'lodash.isequal';\n\nimport { withStyles } from '@material-ui/core/styles';\nimport { MuiThemeProvider } from '@material-ui/core/styles';\n\nimport Loader from '@iobroker/adapter-react/Components/Loader';\nimport I18n from '@iobroker/adapter-react/i18n';\nimport GenericApp from '@iobroker/adapter-react/GenericApp';\n\nimport Layout from './components/Layout';\n\nconst styles = theme => ({\n    root: {},\n    logo: {\n        width: 32,\n        height: 32,\n        padding: theme.spacing(1),\n        display: 'inline-block',\n    },\n});\n\nclass App extends GenericApp {\n    constructor(props) {\n        const extendedProps = {...props};\n        extendedProps.translations = {\n            'en': require('./i18n/en'),\n            'de': require('./i18n/de'),\n            'ru': require('./i18n/ru'),\n            'pt': require('./i18n/pt'),\n            'nl': require('./i18n/nl'),\n            'fr': require('./i18n/fr'),\n            'it': require('./i18n/it'),\n            'es': require('./i18n/es'),\n            'pl': require('./i18n/pl'),\n            'zh-cn': require('./i18n/zh-cn'),\n        };\n\n        super(props, extendedProps);\n    }\n\n    onConnectionReady() {\n        const newState = {};\n\n        this.socket\n            .getSystemConfig()\n            .then(systemConfig => {\n                newState.systemConfig = systemConfig;\n                return this.readConfig();\n            })\n            .then(config => {\n                console.log(config);\n                newState.config = config || false;\n                newState.ready = true;\n                this.setState(newState);\n                if (config.language !== I18n.getLanguage() && config.language) {\n                    I18n.setLanguage(config.language);\n                }\n            })\n            .catch(e => this.showError(e));\n    }\n\n    readConfig() {\n        return this.socket\n            .getObject(`system.adapter.${this.adapterName}.${this.instance}`)\n            .then(config => {\n                config = config || {};\n                const native = config.native || {};\n                native.rules = native.rules || [];\n                native.sayitInstance = native.sayitInstance || '';\n                native.language = native.language || '';\n                native.processorId = native.processorId || '';\n                native.processorTimeout = native.processorTimeout || 1000;\n                return native;\n            });\n    }\n\n    saveConfig(config) {\n        return this.socket\n            .getObject(`system.adapter.${this.adapterName}.${this.instance}`)\n            .then(obj => {\n                if (!isEqual(obj.native, config)) {\n                    obj.native = config;\n                    return this.socket.setObject(\n                        `system.adapter.${this.adapterName}.${this.instance}`,\n                        obj\n                    );\n                }\n            });\n    }\n\n    render() {\n        if (!this.state.config || !this.state.ready) {\n            return <MuiThemeProvider theme={this.state.theme}>\n                <Loader theme={this.state.themeType} />\n                {this.state.config === false ? <div>No instance found</div> : null}\n            </MuiThemeProvider>;\n        }\n\n        return <MuiThemeProvider theme={this.state.theme}>\n            <div className=\"App\">\n                <Layout\n                    themeType={this.state.themeType}\n                    theme={this.state.theme}\n                    socket={this.socket}\n                    instance={this.instance}\n                    readConfig={this.readConfig.bind(this)}\n                    saveConfig={this.saveConfig.bind(this)}\n                />\n                {this.renderError()}\n            </div>\n        </MuiThemeProvider>;\n    }\n}\n\nexport default withStyles(styles)(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as Sentry from '@sentry/browser';\nimport * as SentryIntegrations from '@sentry/integrations';\nimport { MuiThemeProvider } from '@material-ui/core/styles';\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.css';\nimport App from './App';\nimport { version } from '../package.json';\nimport theme from '@iobroker/adapter-react/Theme';\nimport Utils from '@iobroker/adapter-react/Components/Utils';\n\nwindow.adapterName = 'text2command';\nlet themeName = Utils.getThemeName();\n\nconsole.log('iobroker.' + window.adapterName + '@' + version + ' using theme \"' + themeName + '\"');\n\nfunction build() {\n    return ReactDOM.render(\n        <MuiThemeProvider theme={theme(themeName)}>\n            <App\n                onThemeChange={_theme => {\n                    themeName = _theme;\n                    build();\n                }}\n            />\n        </MuiThemeProvider>,\n        document.getElementById('root')\n    );\n}\n\n\n// if not local development\nif (window.location.host !== 'localhost:3000') {\n    Sentry.init({\n        dsn: 'https://9806f910556240219f831ecfe2ee3ad1@sentry.iobroker.net/87',\n        release: 'iobroker.' + window.adapterName + '@' + version,\n        integrations: [new SentryIntegrations.Dedupe()],\n    });\n}\n\nbuild();\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}